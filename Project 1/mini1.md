## <font class="text-color-13" color="#ffeb3b">前言</font>
- 这个小项目的截止日期是10月5日晚上11:59（蒙特利尔时间，东部标准时间）。每延迟k天，就会有2k%的惩罚，也就是说你的成绩将按照100 - 2k来计算。延迟6天后，将不再接受提交。
- 这个小项目需要三人一组完成。除非有组员没有回应或者没有为项目做出贡献，否则所有组员将获得相同的成绩。如果出现这种情况并且有重大冲突，请向小组助教寻求帮助，并在提交的报告中标明这一点。请注意，我们并不期望所有团队成员都能做出平等的贡献。然而，每个团队成员都应对项目做出重要贡献，了解提交内容的内容，并学习提交的完整解决方案。
- 你们将作为一个小组在MyCourses上提交你们的作业。你必须在MyCourses上注册你们的小组，任何小组成员都可以提交。详情请参阅MyCourses。
- 我们建议你使用Overleaf来撰写你的报告，并使用Google colab进行编码和运行实验。后者还可以提供所需的计算资源。这两个平台都支持远程协作。
- 你应该使用Python来完成这个和接下来的小项目。除非任务描述中另有说明，否则你可以自由使用带有通用工具的库，如Python的matplotlib、numpy和scipy。特别是，在大多数情况下，你应该自己实现模型和评估函数，这意味着你不应该使用SciKit learn和其他包中已经存在的算法或函数的实现。任务描述将在每个案例中具体说明这一点。

## <font class="text-color-13" color="#ffeb3b">背景</font>
在这个小项目中，你将实现两个机器学习模型——线性回归和逻辑回归（使用梯度下降）——并对这两个模型在两个不同的数据集上进行分析。目标是开始进行机器学习的编程，并了解这两种常用模型的工作原理。

## <font class="text-color-13" color="#ffeb3b">任务1：</font>
获取、预处理和分析数据 你的第一项任务是获取数据，分析它，并进行清洗（如果需要的话）。在这个项目中，我们将使用两个固定的数据集，如下所述。 
- 数据集1：波士顿房价数据集 1 https://www.kaggle.com/datasets/fedesoriano/the-boston-houseprice-data?select=boston. csv 或者 http://lib.stat.cmu.edu/datasets/boston 这个数据集包含506个数据样本和14个实数属性。使用13个属性，其中一个特征叫做“B”应该从数据集中移除，因为它存在一些道德问题。目标值是以1000美元为单位的自住房中位数（'MEDV’特征）。你可以直接从之前给出的Kaggle链接或者CMU大学的其他链接下载它： 
- 数据集2：葡萄酒数据集： https://archive.ics.uci.edu/dataset/109/wine 这个数据集包含178个数据样本和13个属性。该数据集分布在三个不同的类别中。 这部分项目的主要子任务包括：

将数据集加载到Python的NumPy或Pandas对象中。
清理数据。是否有任何缺失或格式错误的特征？是否有任何其他需要处理的数据奇怪之处？你应该删除任何带有缺失或格式错误特征的示例，并在你的报告中注明这一点。 如果你选择使用Pandas dataframe，那么可能会有一个方便的代码行df[ df.eq(’?’).any(1)]，其中df是dataframe，'?'代表数据集中的缺失值。这是一个简单的处理这个问题的方法，只需消除带有缺失值的行即可。你也可以探索其他可能的方法。
计算数据的基本统计信息以更好地理解它。例如，不同类别的分布是什么，一些数值特征的分布是什么？

## <font class="text-color-13" color="#ffeb3b">任务2：</font>
实现模型
你可以自由地按照你认为合适的方式实现这些模型，但你应该遵循讲座幻灯片中提出的方程，而且你必须从头开始实现模型（也就是说，你不能使用SciKit Learn或任何其他已经存在的这些方法的实现）。然而，你可以自由地使用课程网站上给出的相关代码。
特别是，这部分的三个主要任务是：
1. 为数据集1实现解析线性回归解决方案。
2. 为数据集2实现梯度下降的逻辑回归。
3. 为线性回归和逻辑回归实现小批量随机梯度下降。

你可以以任何你想要的方式实现这些模型，但你必须使用Python，并且必须从头开始实现模型（也就是说，你不能使用SciKit Learn或类似的库）。然而，使用NumPy或Pandas包是允许和鼓励的。关于实现，我们推荐以下方法（但再次强调，你可以自由地做你想做的事）：
- 将两个模型都实现为Python类。你应该使用类的构造函数来初始化模型参数作为属性，以及定义模型的其他重要属性。
- 你的每个模型类应该有（至少）两个函数：

  - 定义一个fit函数，它接受训练数据（即X和Y）以及其他超参数（例如，学习率和批量大小）作为输入。这个函数应该通过修改模型参数来训练你的模型。
  - 定义一个predict函数，它接受一组输入点（即X）作为输入，并输出这些点的预测（即y^）。

## <font class="text-color-13" color="#ffeb3b">任务3：</font>
运行实验
这个项目的目标是让你熟悉如何训练模型。
将每个数据集分为训练集和测试集。在用训练集训练模型后，使用测试集来估计所有实验的性能。使用相应的成本函数来评估分类和回归任务的性能。你可以自由地进行任何你认为合适的实验和分析，但至少你必须按照下面的顺序完成以下实验：
1. 对于两个数据集，执行80/20的训练/测试划分，并报告每个模型在训练集和测试集上的性能指标。请包括诸如线性回归的均方误差（MSE）以及逻辑回归的准确率、精确度、召回率和F1分数等指标。
2. 对于两个数据集，使用5折交叉验证技术，并报告每个模型在训练集和测试集上的性能指标。同样，包括每个模型的适当性能指标。查看这个链接以获取更多信息。
注意：5折交叉验证是一种技术，其中数据集被划分为五个相等的部分（折），并且一个模型被训练和评估五次，每次使用一个不同的折作为验证集，剩余的四个折作为训练集。
3. 对于两个数据集，采样增长的训练数据子集（20%，30%，...80%）。观察并解释训练数据的大小如何影响两个模型的性能。画出两条曲线作为训练大小的函数，一条用于训练中的性能，一条用于测试。
4. 对于两个数据集，尝试增大小批量大小，例如8、16、32、64和128。比较不同批量大小与完全批处理基线的收敛速度和最终性能。你尝试过的配置中哪一个效果最好？
注意：这只适用于SGD（任务2，第三个主要任务）。
5. 对于两个数据集，给出至少三种不同学习率（你自己选择）下线性回归和逻辑回归的性能。
6. 对于两个数据集，在给定各种参数配置的情况下，选择一个性能指标并呈现每个数据集的最优参数选择。请提供你选择该指标的理由，以及你为什么选择该特定指标的解释。
7. 仅对数据集1，
- 高斯基函数：
  - 利用高斯基函数来丰富数据集1的特征集。
  - 定义每一个高斯基函数如下：
  $$
  \phi_j(x) = \exp\left(-\frac{(x-\mu_j)^2}{2s^2}\right)
  $$

  - 使用总共5个高斯基函数。
  - 将空间尺度参数s设置为1。
  - 从训练集中随机选择µj值来确定这些基函数的中心。
  - 使用解析线性回归来预测目标值。

  - 比较新数据集得到的目标值和预测值与原始特征集得到的结果，即与没有高斯基函数得到的结果进行比较。
1. 仅对数据集1，比较解析线性回归解决方案与小批量随机梯度下降法线性回归解决方案。你发现了什么？为什么当有解析解可用时会使用小批量随机梯度下降法？
- 注意：以上实验是你必须完成的最低要求；然而，这个项目是开放式的。例如，当你给梯度下降实现添加动量时会发生什么？如果你添加了正则化会怎样？如果对分类和回归问题使用不同的评估指标会怎样？哪种特征预处理可以提高性能？你不需要做所有这些事情，但你应该在你选择的实验中展示创造性、严谨性和对课程材料的理解，并在你的报告中报告它们。

## <font class="text-color-13" color="#ffeb3b">交付物</font>
你必须将两个单独的文件提交到MyCourses（使用下面详细说明的确切文件名和文件类型）：
1. code.zip：你的数据处理、分类和评估代码（作为.py和.ipynb文件的某种组合）。
2. writeup.pdf：你的（最多5页）项目报告作为pdf（详细信息如下）。

项目报告
你的团队必须提交一个最多五页的项目报告（单行间距，11pt或更大字体；最小0.5英寸边距，可以使用额外一页进行参考/参考内容）。我们强烈建议学生使用LaTeX来完成他们的报告。这个第一个小项目报告有相对严格的要求，但随着课程的进展，你的项目报告将变得越来越开放。你在报告结果方面有一些灵活性，但你必须遵循以下结构和最低要求：

摘要（100-250字）总结项目任务和你最重要的发现。例如，包括像“在这个项目中，我们研究了两个机器学习模型在两个基准数据集上的性能”这样的句子。

引言（5+句子）总结项目任务、两个数据集和你最重要的发现。这应该与摘要相似，但更详细。你应该包括背景信息和引用相关工作（例如，其他分析这些数据集的论文）。

数据集（5+句子）简要描述数据集以及你如何处理它们。呈现你为了理解数据而做的探索性分析，例如类分布。强调在处理这些类型的数据集时可能出现的任何可能的道德问题。

结果（7+句子，可能带有图表或表格）描述任务3中提到的所有实验的结果（至少），以及你发现的任何其他有趣结果（注意：展示图表或表格将是报告这些结果的理想方式）。

讨论和结论（5+句子）总结项目的关键收获以及可能进行进一步调查的方向。

贡献声明（1-3句子）陈述团队成员之间工作量的分配。

参考文献和附录请考虑通过包含额外细节，如图表和引用重要论文作为信息来源来提高这一部分的质量。值得注意的是，这一部分不受5页限制。因此，你可以灵活地进行更多实验，并在此部分中包含相关图表，可以在结果和讨论中进行交叉引用，以便进行更全面的展示。

## <font class="text-color-13" color="#ffeb3b">评估</font>
这个小项目总分为100分，评估细则如下：
- 完整性（20分）
  - 你是否提交了所有的材料？
  - 你是否运行了所有必需的实验？
  - 你是否遵循了项目报告的指导原则？
- 正确性（40分）
  - 你的模型实现是否正确？
  - 你报告的性能是否接近我们的解决方案？
  - 你在实验中是否观察到正确的趋势（例如，随着小批量或学习率的变化，性能如何变化？）？
  - 你是否发现了决策边界的显著特征？
- 写作质量（25分）
  - 你的报告是否清晰，没有语法错误和拼写错误？
  - 你是否超越了写作的最低要求（例如，在引言中包含相关工作的讨论）？
  - 你是否有效地呈现了数值结果（例如，通过表格或图形）？
- 原创性/创造性（15分）
  - 你是否超越了实验的最低要求？
  - 注意：简单地添加一个随机的新实验并不能保证在这一部分得到高分！你在报告中应该有思考和组织。也就是说，你提出的独特想法应该融入你的整个故事中。例如，解释它们背后的触发因素将是一个很好的起点。
 
## <font class="text-color-13" color="#ffeb3b">最后的话</font>
我们期望你展现出主动性、创造性、科学严谨性、批判性思维和良好的沟通技巧。你不需要限制自己在上面列出的要求中 - 你可以自由地超越，进一步探索。 你可以与其他团队的成员讨论方法和技术问题，但你不能与其他团队分享任何代码或数据。 恭喜你完成了你的第一个课程项目！你现在已经熟悉了两个最常用的机器学习模型。随着课程的进行，我们将看到更多的机器学习模型及其在现实生活中的有趣应用。